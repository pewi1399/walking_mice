<!DOCTYPE html>
<meta charset="utf-8">
<style> /* set the CSS */

.line {
  stroke: grey;
  stroke-width: 1px;
  opacity: 0
}

.dot{
  opacity:0;
}

.text{
  font-size: 20px;
}

</style>
<body>

<!-- load the d3.js library -->
<script src="src/d3/d3.min.js"></script>
<link rel="stylesheet" href="src/bootstrap.3.3.7/css/bootstrap.min.css">
<script>

// set the dimensions and margins of the graph
var margin = {top: 20, right: 20, bottom: 30, left: 50},
    width = 1000 - margin.left - margin.right,
    height = 500 - margin.top - margin.bottom;

var data = [
{name:"tid", roligt:-3, latt:0, main:1, color: "dodgerblue"},
{name:"tid", roligt:0, latt:-2.4, main:0, color: "dodgerblue"},
{name:"tid", roligt:0, latt:2.2, main:0, color: "dodgerblue"},
{name:"utveckling", roligt:8, latt:-9, main:1, color: "mediumseagreen"},
{name:"utveckling", roligt:8, latt:0, main:0, color: "mediumseagreen"},
{name:"utveckling", roligt:0, latt:0, main:0, color: "mediumseagreen"},
{name:"utveckling", roligt:0, latt:-2.4, main:0, color: "mediumseagreen"},
{name:"kultur", roligt:8, latt:8, main:1, color: "firebrick"},
{name:"kultur", roligt:8, latt:0, main:0, color: "firebrick"},
{name:"kultur", roligt:0, latt:0, main:0, color: "firebrick"},
{name:"kultur", roligt:0, latt:2.2, main:0, color: "firebrick"}
]

// set the ranges
var x = d3.scaleLinear().range([0, height]);
var y = d3.scaleLinear().range([height, 0]);

// define the line
var valueline = d3.line()
    .x(function(d) { return x(d.roligt); })
    .y(function(d) { return y(d.latt); })
    .curve(d3.curveLinearClosed);

// append the svg obgect to the body of the page
// appends a 'group' element to 'svg'
// moves the 'group' element to the top left margin
var svg = d3.select("body").append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
  .append("g")
    .attr("transform",
          "translate(" + margin.left + "," + margin.top + ")");

// Get the data

  //  the range of the data
  x.domain([-10, 10]);
  y.domain([-10,10]);


  // Add the valueline path.
  svg.append("path")
      .data([data.filter(function(d) { return d.main  == 1 })])
      .attr("class", "line")
      .attr("fill", "lightgrey")
      .attr("d", valueline);

    svg.append("path")
        .data([data.filter(function(d) { return d.name  == "tid" })])
        .attr("id", "tid")
        .attr("fill", "grey")
        .attr("class", "line")
        .attr("d", valueline)
        .on("click", function(){

           d3.selectAll(".line")
           .transition()
           .duration(1000)
           .attr("fill", "grey")
           .style("stroke", "grey")
           .style("stroke-width", "1px");

           d3.selectAll("#" + this.id)
           .transition()
           .duration(1000)
           .attr("fill", "orange")
           .style("stroke", "darkorange")
           .style("stroke-width", "4px");
        });

   svg.append("path")
       .data([data.filter(function(d) { return d.name  == "utveckling" })])
        .attr("id", "utveckling")
       .attr("fill", "grey")
       .attr("class", "line")
       .attr("d", valueline)
       .on("click", function(){

          d3.selectAll(".line")
          .transition()
          .duration(1000)
          .attr("fill", "grey")
          .style("stroke", "grey")
          .style("stroke-width", "1px");

          d3.selectAll("#" + this.id)
          .transition()
          .duration(1000)
          .attr("fill", "orange")
          .style("stroke", "darkorange")
          .style("stroke-width", "4px");
       });

   svg.append("path")
       .data([data.filter(function(d) { return d.name  == "kultur" })])
        .attr("id", "kultur")
       .attr("fill", "grey")
       .attr("class", "line")
       .attr("d", valueline)
       .on("click", function(){

          d3.selectAll(".line")
          .transition()
          .duration(1000)
          .attr("fill", "grey")
          .style("stroke", "grey")
          .style("stroke-width", "1px");

          d3.selectAll("#" + this.id)
          .transition()
          .duration(1000)
          .attr("fill", "orange")
          .style("stroke", "darkorange")
          .style("stroke-width", "4px");
       });




  // Add the scatterplot
  svg.selectAll("dot")
      .data(data.filter(function(d) { return d.main  == 1 }))
    .enter().append("circle")
      .attr("r", 5)
      .attr("class", "dot")
      .attr("id", function(d){ return d.name + "dot";})
      .attr("fill", function(d){ return d.color})
      .attr("cx", function(d) { return x(d.roligt); })
      .attr("cy", function(d) { return y(d.latt); });

  // Add the X Axis
  var xax = svg.append("g")
      //.attr("transform", "translate(0," + height + ")")
      .attr("transform", "translate(0," + y.range()[0] / 2 + ")")
      .call(d3.axisBottom(x));

      xax.append("text")
        //.attr("transform", "rotate(-90)")
        .attr("y", -7)
        .attr("dx", "0.71em")
        .attr("fill", "#000")
        .text("Tråkigt");

      xax.append("text")
        //.attr("transform", "rotate(-90)")
        .attr("y", -7)
        .attr("x", 430)
        .attr("dx", "0.71em")
        .attr("fill", "#000")
        .text("Roligt");

  // Add the Y Axis
  var yax = svg.append("g")
      .attr("transform", "translate(" + x.range()[1] / 2 +  ",0)")
      .call(d3.axisLeft(y));

    yax.append("text")
      .attr("transform", "rotate(-90)")
      .attr("y", 7)
      .attr("dy", "0.71em")
      .attr("fill", "#000")
      .text("Lätt");

    yax.append("text")
      .attr("transform", "rotate(-90)")
      .attr("y", 7)
      .attr("x", -430)
      .attr("dy", "0.71em")
      .attr("fill", "#000")
      .text("Svårt");


var maltext = svg.selectAll("#maltext")
.data([1])
.enter()
.append("text")
.attr("id", "maltext")
.attr("x", 500)
.attr("y", 230)



//functions
drawpaths = function(){
  d3.selectAll(".line")
  .transition()
  .duration(1500)
  .style("opacity", 0.8)
}

var iter = 1

analysera = function(){
  if(iter == 1){
    drawpaths()
    maltext.remove()

    svg.selectAll("#header1")
    .data([1])
    .enter()
    .append("text")
    .attr("id", "header1")
    .attr("x", 500)
    .attr("y", 70)
    .text("Avdelnings operationsområde kan alltså beskrivas som en yta")

    svg.selectAll("#header2")
    .data([1])
    .enter()
    .append("text")
    .attr("id", "header1")
    .attr("x", 500)
    .attr("y", 85)
    .text("som avgränsas av dessa tre mål")

    window.iter = iter +1
  }else if(iter == 2){

  svg.selectAll("#mal1")
    .data([1])
    .enter()
    .append("text")
    .attr("id", "header")
    .attr("x", 500)
    .attr("y", 200)
    .text("* Endast 6% av uppgifterna är att rent tekniskt sett tråkiga.")

    d3.selectAll(".line")
    .transition()
    .duration(1000)
    .attr("fill", "grey")
    .style("stroke", "grey")
    .style("stroke-width", "1px");

    d3.selectAll("#tid")
    .transition()
    .duration(1000)
    .attr("fill", "orange")
    .style("stroke", "darkorange")
    .style("stroke-width", "4px");

    window.iter = iter +1

  }else if(iter == 3){

    svg.selectAll("#mal2")
      .data([1])
      .enter()
      .append("text")
      .attr("id", "header")
      .attr("x", 500)
      .attr("y", 250)
      .text("* Hela 49% är härligt utmanande.")

      d3.selectAll(".line")
      .transition()
      .duration(1000)
      .attr("fill", "grey")
      .style("stroke", "grey")
      .style("stroke-width", "1px");

      d3.selectAll("#utveckling")
      .transition()
      .duration(1000)
      .attr("fill", "orange")
      .style("stroke", "darkorange")
      .style("stroke-width", "4px");

    window.iter = iter +1

  }else if(iter == 4){

    svg.selectAll("#mal2")
      .data([1])
      .enter()
      .append("text")
      .attr("id", "header")
      .attr("x", 500)
      .attr("y", 300)
      .text("* Resterande 45% är i strikt mening att betrakta som lek.")

      d3.selectAll(".line")
      .transition()
      .duration(1000)
      .attr("fill", "grey")
      .style("stroke", "grey")
      .style("stroke-width", "1px");

      d3.selectAll("#kultur")
      .transition()
      .duration(1000)
      .attr("fill", "orange")
      .style("stroke", "darkorange")
      .style("stroke-width", "4px");

    window.iter = iter +1

  }
}

var itermal = 1

mal = function(){
  if(itermal == 1){
    maltext.text("Mål 1. I tid: inte alltid så kul men varken enkelt eller svårt")

    d3.select("#tiddot")
    .transition()
    .duration(1000)
    .style("opacity", 0.8)

    window.itermal = itermal +1
  }else if(itermal == 2){
    maltext.text("Mål 2. Data till information: Svårt och stimulerande")

    d3.select("#utvecklingdot")
    .transition()
    .duration(1000)
    .style("opacity", 0.8)

    window.itermal = itermal +1
  }else if(itermal == 3){
    maltext.text("Mål 3. God kultur: borde komma naturligt och är både enkelt och roligt")

    d3.select("#kulturdot")
    .transition()
    .duration(1000)
    .style("opacity", 0.8)

    window.itermal = itermal +1
  }
}


  // Add polygon
//  var trianglePoints = x(3) + ' ' + y(18) + ', ' + x(1) + ' ' + y(0) + ', ' + x(12) + ' ' + y(3) + ' ' + x(12) + ', ' + y(3) + ' ' + x(3) + ' ' + y(18);
//
//console.log(trianglePoints);
//
//svg.append('polyline')
//    .attr('points', trianglePoints)
//    .style('stroke', 'blue');
 //$('').

</script>

<button id = "knappen" type="button" class="btn btn-primary" onclick = "mal();" >Mål</button>
<button type="button" class="btn btn-danger" onclick = "analysera();">Analysera</button>


</body>
